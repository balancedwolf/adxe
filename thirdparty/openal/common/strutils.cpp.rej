--- a/common/strutils.cpp
+++ b/common/strutils.cpp
@@ -45,18 +45,22 @@ namespace al {
 
 al::optional<std::string> getenv(const char *envname)
 {
+#if (defined WINAPI_FAMILY && WINAPI_FAMILY == WINAPI_FAMILY_DESKTOP_APP) || !defined _WIN32
     const char *str{std::getenv(envname)};
     if(str && str[0] != '\0')
         return al::make_optional<std::string>(str);
+#endif
     return al::nullopt;
 }
 
 #ifdef _WIN32
 al::optional<std::wstring> getenv(const WCHAR *envname)
 {
+#if (defined WINAPI_FAMILY && WINAPI_FAMILY == WINAPI_FAMILY_DESKTOP_APP) || !defined _WIN32
     const WCHAR *str{_wgetenv(envname)};
     if(str && str[0] != L'\0')
         return al::make_optional<std::wstring>(str);
+#endif
     return al::nullopt;
 }
 #endif
